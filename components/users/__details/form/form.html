{% set user = access().getUser() %}
{% set user = createModel('Users').findById(user.uuid) %}
{% set user_details = createModel('UserDetails','users').findByColumn(user.id,'user_id') %}   

<form class="ui equal width inverted form" id="user_details_form">   
    <div class="two fields">
        <div class="field required">
            <label>{{ fields.user_name.label }}</label>
            <div class="ui left icon input">
                <i class="icon user outline"></i>
                <input type="text" name="user_name" id="user_name" {{ fields.user_name.placeholder|attr('placeholder') }} value="{{ user.user_name }}"> 
            </div>
        </div>   
        {{  component('components:form.fields.checkbox',{ 
                value: user_details.public_profile, 
                name: 'public_profile',
                field_class : 'toggle',
                label: fields.public.label 
            }) 
        }}  
    </div>
    <div class="two fields">
        <div class="field">
            <label>{{ fields.email.label }}</label>
            <div class="ui left icon input">
                <i class="icon mail outline"></i>
                <input type="text" name="email" id="email" {{ fields.email.placeholder|attr('placeholder') }} value="{{ user.email }}">  
            </div>
        </div>  
        <div class="field">
            <div class="mt-8">
                <a class="ui button tertiary blue" target="profile" href="{{ user_details.getUserProfileUrl() }}">View Profile</a>
            </div>         
        </div>
    </div>    
    {{ component('components:form.footer') }}    
</form>